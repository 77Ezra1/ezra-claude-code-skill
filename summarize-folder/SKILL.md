---
name: summarize-folder
description: ç›®å½•æ–‡ä»¶éå†å’Œå†…å®¹æ€»ç»“ã€‚å½“ç”¨æˆ·éœ€è¦åˆ†ææ•´ä¸ªç›®å½•/æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶æ—¶è§¦å‘ï¼šéå†ç›®å½•ã€è¯†åˆ«æ–‡ä»¶ç±»å‹ã€æå–å¤šç§æ ¼å¼æ–‡ä»¶å†…å®¹ï¼ˆdocx/pdf/xlsx/txt/md/csvç­‰ï¼‰ã€ç”Ÿæˆç»“æ„åŒ–æ€»ç»“ã€‚è§¦å‘è¯ï¼šæ€»ç»“è¿™ä¸ªç›®å½•ã€åˆ†æè¿™ä¸ªæ–‡ä»¶å¤¹ã€çœ‹çœ‹è¿™ä¸ªç›®å½•æœ‰ä»€ä¹ˆã€éå†æ–‡ä»¶å¤¹ã€å¸®æˆ‘çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶å¤¹
user-invocable: true
---

# ç›®å½•æ–‡ä»¶éå†å’Œå†…å®¹æ€»ç»“

## è§¦å‘æ¡ä»¶

å½“ç”¨æˆ·è¯´ä»¥ä¸‹å†…å®¹æ—¶è‡ªåŠ¨è§¦å‘ï¼š
- "å¸®æˆ‘æ€»ç»“è¿™ä¸ªç›®å½•" / "æ€»ç»“è¿™ä¸ªæ–‡ä»¶å¤¹"
- "åˆ†æè¿™ä¸ªç›®å½•" / "çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶å¤¹æœ‰ä»€ä¹ˆ"
- "éå†æ–‡ä»¶å¤¹" / "æŸ¥çœ‹ç›®å½•å†…å®¹"
- "è¿™ä¸ªç›®å½•é‡Œæœ‰ä»€ä¹ˆæ–‡ä»¶" / "å¸®æˆ‘çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶å¤¹"

## å·¥ä½œæµç¨‹

### ç¬¬ä¸€æ­¥ï¼šç¡®è®¤ç›®æ ‡ç›®å½•

é¦–å…ˆç¡®è®¤ç”¨æˆ·è¦åˆ†æçš„ç›®å½•è·¯å¾„ï¼š
- å¦‚æœç”¨æˆ·æä¾›äº†è·¯å¾„ï¼Œç›´æ¥ä½¿ç”¨
- å¦‚æœæ²¡æœ‰æä¾›ï¼Œè¯¢é—®ç”¨æˆ·å…·ä½“ç›®å½•è·¯å¾„
- æ”¯æŒç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„

### ç¬¬äºŒæ­¥ï¼šéå†ç›®å½•ç»“æ„

ä½¿ç”¨ `find` å‘½ä»¤éå†ç›®å½•ï¼Œè·å–æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨ï¼š

```bash
# éå†ç›®å½•ï¼ŒæŒ‰ç±»å‹åˆ†ç±»æ˜¾ç¤ºæ–‡ä»¶
find "<ç›®å½•è·¯å¾„>" -type f | head -100
```

ç»Ÿè®¡æ–‡ä»¶ç±»å‹åˆ†å¸ƒï¼š
```bash
find "<ç›®å½•è·¯å¾„>" -type f -name "*.docx" | wc -l  # Word æ–‡æ¡£
find "<ç›®å½•è·¯å¾„>" -type f -name "*.pdf" | wc -l   # PDF æ–‡æ¡£
find "<ç›®å½•è·¯å¾„>" -type f -name "*.xlsx" -o -name "*.xls" -o -name "*.csv" | wc -l  # Excel/è¡¨æ ¼
find "<ç›®å½•è·¯å¾„>" -type f -name "*.txt" -o -name "*.md" | wc -l  # æ–‡æœ¬æ–‡ä»¶
find "<ç›®å½•è·¯å¾„>" -type f -name "*.pptx" | wc -l  # PowerPoint
```

### ç¬¬ä¸‰æ­¥ï¼šæŒ‰æ–‡ä»¶ç±»å‹æå–å†…å®¹

#### DOCX (Word æ–‡æ¡£) - ä½¿ç”¨ pandoc

```bash
# æå–å•ä¸ªæ–‡æ¡£å†…å®¹
pandoc "<æ–‡ä»¶è·¯å¾„>.docx" -t markdown -o temp_output.md

# æ‰¹é‡æå–
find "<ç›®å½•è·¯å¾„>" -type f -name "*.docx" -exec sh -c 'pandoc "$1" -t markdown --output="$1.md"' _ {} \;
```

#### PDF - ä½¿ç”¨ pdfplumber æˆ– pdftotext

```python
# Python è„šæœ¬æå– PDF å†…å®¹
import pdfplumber
import sys

def extract_pdf_text(pdf_path):
    text = ""
    with pdfplumber.open(pdf_path) as pdf:
        for page in pdf.pages:
            text += page.extract_text() + "\n"
    return text

if __name__ == "__main__":
    print(extract_pdf_text(sys.argv[1]))
```

æˆ–ä½¿ç”¨å‘½ä»¤è¡Œï¼š
```bash
pdftotext "<æ–‡ä»¶è·¯å¾„>.pdf" -  # è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º
pdftotext "<æ–‡ä»¶è·¯å¾„>.pdf" output.txt  # è¾“å‡ºåˆ°æ–‡ä»¶
```

#### XLSX/XLS/CSV (Excel å’Œè¡¨æ ¼) - ä½¿ç”¨ pandas

```python
# Python è„šæœ¬è¯»å–è¡¨æ ¼å†…å®¹
import pandas as pd
import sys

def extract_spreadsheet(file_path):
    try:
        if file_path.endswith('.csv'):
            df = pd.read_csv(file_path)
        else:
            # è¯»å–æ‰€æœ‰ sheet
            excel_file = pd.ExcelFile(file_path)
            result = f"æ–‡ä»¶: {file_path}\nSheet åˆ—è¡¨: {excel_file.sheet_names}\n\n"
            for sheet_name in excel_file.sheet_names:
                df = pd.read_excel(file_path, sheet_name=sheet_name)
                result += f"--- Sheet: {sheet_name} ---\n"
                result += f"å½¢çŠ¶: {df.shape}\n"
                result += f"åˆ—å: {list(df.columns)}\n"
                result += f"é¢„è§ˆ:\n{df.head(10).to_string()}\n\n"
            return result
    except Exception as e:
        return f"é”™è¯¯: {str(e)}"

if __name__ == "__main__":
    print(extract_spreadsheet(sys.argv[1]))
```

æˆ–ä½¿ç”¨å‘½ä»¤è¡Œå¿«é€ŸæŸ¥çœ‹ï¼š
```bash
# CSV æ–‡ä»¶
cat "<æ–‡ä»¶è·¯å¾„>.csv" | head -50

# XLSX æ–‡ä»¶ï¼ˆéœ€è¦ pythonï¼‰
python -c "import pandas as pd; df = pd.read_excel('<æ–‡ä»¶è·¯å¾„>.xlsx'); print(df.to_string())"
```

#### TXT/MD (æ–‡æœ¬æ–‡ä»¶)

```bash
# ç›´æ¥è¯»å–
cat "<æ–‡ä»¶è·¯å¾„>.txt"

# Markdown æ–‡ä»¶
cat "<æ–‡ä»¶è·¯å¾„>.md"
```

#### PPTX (PowerPoint)

```bash
# ä½¿ç”¨ pandoc æå–
pandoc "<æ–‡ä»¶è·¯å¾„>.pptx" -t markdown -o output.md
```

### ç¬¬å››æ­¥ï¼šç”Ÿæˆç»“æ„åŒ–æ€»ç»“

å°†æ‰€æœ‰æå–çš„å†…å®¹æ•´ç†æˆä»¥ä¸‹ç»“æ„ï¼š

```markdown
# ç›®å½•æ€»ç»“æŠ¥å‘Š

## ç›®å½•æ¦‚è§ˆ
- **è·¯å¾„**: [ç›®å½•è·¯å¾„]
- **æ–‡ä»¶æ€»æ•°**: [æ•°é‡]
- **å­ç›®å½•æ•°**: [æ•°é‡]

## æ–‡ä»¶ç±»å‹åˆ†å¸ƒ
| ç±»å‹ | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| Word (.docx) | X | æ–‡æ¡£æ–‡ä»¶ |
| PDF | X | PDF æ–‡æ¡£ |
| Excel | X | è¡¨æ ¼æ–‡ä»¶ |
| æ–‡æœ¬ (.txt/.md) | X | æ–‡æœ¬æ–‡ä»¶ |
| å…¶ä»– | X | å…¶ä»–æ ¼å¼ |

## æ–‡ä»¶åˆ—è¡¨åŠå†…å®¹æ‘˜è¦

### 1. [æ–‡ä»¶å1].[æ‰©å±•å]
**è·¯å¾„**: [ç›¸å¯¹è·¯å¾„]
**ç±»å‹**: [æ–‡ä»¶ç±»å‹]
**å¤§å°**: [æ–‡ä»¶å¤§å°]

**å†…å®¹æ‘˜è¦**:
[æå–çš„å…³é”®å†…å®¹/æ‘˜è¦]

---

### 2. [æ–‡ä»¶å2].[æ‰©å±•å]
[åŒä¸Šç»“æ„...]

## æ•´ä½“åˆ†æ

### ä¸»è¦ä¸»é¢˜/å†…å®¹
[åˆ†ææ‰€æœ‰æ–‡ä»¶çš„æ•´ä½“ä¸»é¢˜å’Œå†…å®¹å…³è”]

### å…³é”®ä¿¡æ¯æå–
- [å…³é”®ç‚¹1]
- [å…³é”®ç‚¹2]
- [å…³é”®ç‚¹3]

### å»ºè®®è¡ŒåŠ¨
- [åŸºäºå†…å®¹åˆ†æçš„å»ºè®®]
```

## æ”¯æŒçš„æ–‡ä»¶æ ¼å¼

| æ ¼å¼ | æ‰©å±•å | æå–æ–¹æ³• |
|------|--------|----------|
| Word æ–‡æ¡£ | .docx | pandoc |
| PDF æ–‡æ¡£ | .pdf | pdfplumber / pdftotext |
| Excel è¡¨æ ¼ | .xlsx, .xls | pandas / openpyxl |
| CSV è¡¨æ ¼ | .csv | pandas |
| æ–‡æœ¬æ–‡ä»¶ | .txt | ç›´æ¥è¯»å– |
| Markdown | .md | ç›´æ¥è¯»å– |
| PowerPoint | .pptx | pandoc |
| å›¾ç‰‡ (OCR) | .jpg, .png | pytesseract (å¯é€‰) |

## é”™è¯¯å¤„ç†

- å¦‚æœæ–‡ä»¶æŸåæˆ–æ— æ³•è¯»å–ï¼Œè®°å½•é”™è¯¯ä½†ç»§ç»­å¤„ç†å…¶ä»–æ–‡ä»¶
- å¯¹äºå—å¯†ç ä¿æŠ¤çš„æ–‡ä»¶ï¼Œæç¤ºç”¨æˆ·æä¾›å¯†ç 
- å¯¹äºæ— æ³•è¯†åˆ«çš„æ ¼å¼ï¼Œä½¿ç”¨ `file` å‘½ä»¤æ£€æµ‹ MIME ç±»å‹

## ä¾èµ–å·¥å…·

ç¡®ä¿ä»¥ä¸‹å·¥å…·å¯ç”¨ï¼ˆå¤§éƒ¨åˆ†å·²å†…ç½®åœ¨å®˜æ–¹ skills ä¸­ï¼‰ï¼š

```bash
# æ–‡æ¡£è½¬æ¢
pandoc --version  # Word/PowerPoint è½¬æ¢

# PDF å¤„ç†
pdftotext -v      # PDF æ–‡æœ¬æå–
pip install pdfplumber  # Python PDF å¤„ç†

# Excel å¤„ç†
pip install pandas openpyxl  # Python Excel å¤„ç†

# å›¾ç‰‡ OCR (å¯é€‰)
pip install pytesseract pdf2image
```

## ä½¿ç”¨ç¤ºä¾‹

```
ç”¨æˆ·: å¸®æˆ‘æ€»ç»“è¿™ä¸ªç›®å½•

Claude: å¥½çš„ï¼Œè¯·å‘Šè¯‰æˆ‘ä½ è¦åˆ†æå“ªä¸ªç›®å½•çš„è·¯å¾„ï¼Ÿ

ç”¨æˆ·: C:\Users\Administrator\Documents\work

Claude: å¼€å§‹åˆ†æç›®å½•...
- æ‰«ææ–‡ä»¶...
- å‘ç° 12 ä¸ªæ–‡ä»¶ï¼ˆ3ä¸ªWordæ–‡æ¡£ï¼Œ2ä¸ªPDFï¼Œ5ä¸ªExcelï¼Œ2ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼‰
- æ­£åœ¨æå–å†…å®¹...
- ç”Ÿæˆæ€»ç»“æŠ¥å‘Š...

[è¾“å‡ºç»“æ„åŒ–æ€»ç»“æŠ¥å‘Š]
```

## å¯è§†åŒ–ç•Œé¢

æœ¬ skill é›†æˆäº† **visual-progress æ¡†æ¶**ï¼Œæä¾›ç¾è§‚çš„è¿›åº¦æ˜¾ç¤ºã€‚

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# åŸºæœ¬ç”¨æ³•
python ~/.claude/skills/summarize-folder/scripts/summarize.py <ç›®å½•è·¯å¾„>

# é€’å½’å¤„ç†å­ç›®å½•
python ~/.claude/skills/summarize-folder/scripts/summarize.py <ç›®å½•è·¯å¾„> -r

# ä¿å­˜æŠ¥å‘Šåˆ°æ–‡ä»¶
python ~/.claude/skills/summarize-folder/scripts/summarize.py <ç›®å½•è·¯å¾„> -o report.md

# ä½¿ç”¨æç®€ä¸»é¢˜
python ~/.claude/skills/summarize-folder/scripts/summarize.py <ç›®å½•è·¯å¾„> -t minimal
```

### å¯è§†åŒ–æ•ˆæœ

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ç›®å½•æ–‡ä»¶åˆ†æ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¶ ğŸ“ æ‰«æç›®å½•æ–‡ä»¶...
  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%
  âœ“ å‘ç° 12 ä¸ªæ–‡ä»¶

â–¶ ğŸ“„ æå–æ–‡ä»¶å†…å®¹...
  å¤„ç†: document1.docx [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50%
  ...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ‰ æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â€¢ æ–‡ä»¶æ€»æ•°: 12
  â€¢ æ€»å¤§å°: 2.5 MB
  â€¢ æŠ¥å‘Šé•¿åº¦: 15234 å­—ç¬¦
```

### æ”¯æŒçš„ä¸»é¢˜

| ä¸»é¢˜ | æè¿° | ä½¿ç”¨æ–¹å¼ |
|------|------|----------|
| colorful | å½©è‰²ä¸»é¢˜ï¼ˆé»˜è®¤ï¼‰ | `-t colorful` |
| minimal | æç®€ä¸»é¢˜ï¼ˆæ— é¢œè‰²ï¼‰ | `-t minimal` |

### Python API ä½¿ç”¨

```python
from summarize_folder.scripts.summarize import SummarizeFolderVisual

# åˆ›å»ºåˆ†æå™¨
analyzer = SummarizeFolderVisual(theme="colorful")

# æ‰§è¡Œåˆ†æ
report = analyzer.run(
    directory="/path/to/folder",
    recursive=False,
    output_file="report.md"
)

print(report)
```

## æ³¨æ„äº‹é¡¹

1. **å¤§æ–‡ä»¶å¤„ç†**: å¯¹äºè¶…è¿‡ 100MB çš„æ–‡ä»¶ï¼Œå…ˆè¯¢é—®æ˜¯å¦éœ€è¦å¤„ç†
2. **æ•æ„Ÿä¿¡æ¯**: æå–å†…å®¹æ—¶æ³¨æ„è¯†åˆ«å’Œæé†’æ•æ„Ÿä¿¡æ¯
3. **ç¼–ç é—®é¢˜**: å¯¹äºé UTF-8 ç¼–ç çš„æ–‡ä»¶ï¼Œä½¿ç”¨ `chardet` æ£€æµ‹ç¼–ç 
4. **é€’å½’æ·±åº¦**: é»˜è®¤åªå¤„ç†å½“å‰ç›®å½•ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦éœ€è¦é€’å½’å¤„ç†å­ç›®å½•
5. **æ–‡ä»¶æ•°é‡é™åˆ¶**: å•æ¬¡å¤„ç†å»ºè®®ä¸è¶…è¿‡ 50 ä¸ªæ–‡ä»¶ï¼Œè¶…è¿‡åˆ™å»ºè®®åˆ†æ‰¹å¤„ç†
